# 图像分类项目优化版本 V2.1

## 项目概述
这是一个针对44类图像分类任务的深度学习解决方案的优化版本。本版本在V1版本（EfficientNet-B0）的基础上，升级为使用ConvNeXt Base作为主干网络，并引入了多项先进的训练策略和优化技术。

## 主要特点与改进

### 1. 模型架构升级
- **基础模型**：ConvNeXt Base（替代V1版本的EfficientNet-B0）
  - 预训练权重：IN22K (ImageNet-22K)
  - 更强大的特征提取能力
  - 更适合现代视觉任务

### 2. 训练策略优化

#### 2.1 交叉验证与模型集成
- 3折交叉验证（优化自5折，提升训练效率）
- 保存每折最佳模型
- 模型集成预测

#### 2.2 学习率策略
- 带warmup的余弦退火调度
  - warmup轮数：3 epochs
  - 初始学习率：1e-4
  - 最小学习率：1e-6

#### 2.3 优化器配置
- AdamW优化器
  - 权重衰减：1e-2
  - betas：(0.9, 0.999)
  - eps：1e-8

### 3. 高级训练技术

#### 3.1 混合精度训练
- 使用 torch.cuda.amp
- GradScaler 用于自动缩放梯度

#### 3.2 随机权重平均 (SWA)
- SWA起始轮数可配���
- SWA学习率自动调整
- 定期更新SWA模型参数

#### 3.3 早停机制
- patience：5轮
- 监控指标：验证集准确率
- 最小改善阈值可配置

### 4. 数据增强策略

#### 4.1 基础增强
- RandomResizedCrop
- RandomHorizontalFlip
- 标签平滑：0.1

#### 4.2 混合增强
- Mixup
- CutMix
- 动态概率调整

### 5. 推理优化

#### 5.1 测试时增强 (TTA)
- 水平翻转
- 多尺度测试（0.9x和1.1x）
- 预测结果平均

#### 5.2 性能优化
- 异步数据加载
- 多进程数据预处理
- 批量预测
- GPU内存优化

### 6. 工程实践改进

#### 6.1 监控与日志
- 详细的训练过程日志
- 学习率变化记录
- 性能指标追踪
- 训练时间估算

#### 6.2 错误处理
- 完整的异常捕获
- 模型保存和加载的健壮性检查
- 数据完整性验证

## 环境要求
```
torch>=1.9.0
torchvision>=0.10.0
timm>=0.9.2
pandas>=1.3.0
numpy>=1.21.0
scikit-learn>=1.0.0
tqdm>=4.62.0
```

## 使用说明

### 训练
```bash
python train_advanced_v2.py
```

### 配置修改
修改 config.py 中的相关参数：
- 数据路径配置
- 训练参数设置
- 模型参数调整
- 增强策略选择

## 未来改进方向

1. 模型优化
   - 探索其他先进模型架构
   - 引入注意力机制
   - 尝试知识蒸馏

2. 训练策略
   - 实现动态批次大小
   - 添加对比学习
   - 优化学习率调度策略

3. 工程优化
   - 添加分布式训练支持
   - 实现模型量化
   - 优化推理速度

## 许可证
本项目采用 MIT 许可证。 