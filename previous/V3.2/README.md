# 图像分类项目优化版本 V3.0

## 项目概述
这是一个针对44类图像分类任务的深度学习解决方案的优化版本。本版本升级为使用EfficientNetV2-B2作为主干网络，并引入了更多针对类别不平衡的优化策略。

## 主要特点与改进

### 1. 模型架构升级
- **基础模型**：EfficientNetV2-B2
  - 预训练权重：IN1K (ImageNet-1K)
  - 更高效的特征提取
  - 更快的训练速度
  - 更小的显存占用

### 2. 训练策略优化

#### 2.1 交叉验证与模型集成
- 2折交叉验证（优化自3折，进一步提升训练效率）
- 动态调整折数策略
- 模型集成预测

#### 2.2 学习率策略
- OneCycleLR调度器
  - max_lr: 1e-3
  - pct_start: 0.1
  - div_factor: 25
  - final_div_factor: 1000

#### 2.3 优化器配置
- AdamW优化器
  - 初始学习率：1e-3
  - 权重衰减：1e-2
  - betas：(0.9, 0.999)
  - eps：1e-8

### 3. 类别不平衡处理

#### 3.1 数据层面
- WeightedRandomSampler
- 动态类别权重调整
- 渐进式采样策略

#### 3.2 损失函数层面
- 加权交叉熵损失
- Focal Loss支持
- 标签平滑：0.1

### 4. 训练加速与优化

#### 4.1 混合精度训练
- 自动混合精度
- 梯度缩放
- 显存优化

#### 4.2 早停机制
- patience：3轮
- 监控指标：验证集F1分数
- 最小改善阈值：1e-4

### 5. 推理优化

#### 5.1 测试时增强 (TTA)
- 水平翻转
- 多尺度测试
- 概率平均策略

#### 5.2 性能优化
- 批量推理
- 异步数据加载
- 显存管理优化

### 6. 工程实践改进

#### 6.1 监控与日志
- 详细的训练过程日志
- 学习率变化记录
- 性能指标追踪
- 训练时间估算

#### 6.2 错误处理
- 完整的异常捕获
- 模型保存和加载的健壮性检查
- 数据完整性验证

## 环境要求
```
torch>=1.9.0
torchvision>=0.10.0
timm>=0.9.2
pandas>=1.3.0
numpy>=1.21.0
scikit-learn>=1.0.0
tqdm>=4.62.0
```

## 使用说明

### 训练
```bash
python train_advanced_v2.py
```

### 配置修改
修改 config.py 中的相关参数：
- 数据路径配置
- 训练参数设置
- 模型参数调整
- 增强策略选择

## 未来改进方向

1. 模型优化
   - 探索其他先进模型架构
   - 引入注意力机制
   - 尝试知识蒸馏

2. 训练策略
   - 实现动态批次大小
   - 添加对比学习
   - 优化学习率调度策略

3. 工程优化
   - 添加分布式训练支持
   - 实现模型量化
   - 优化推理速度

## 许可证
本项目采用 MIT 许可证。 