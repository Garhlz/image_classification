# 图像分类项目优化版本 V2

这个项目是一个针对44类图像分类任务的深度学习解决方案。在V2版本中，我们引入了多项先进的优化技术和改进措施，以提升模型的性能和训练效果。

## 主要优化措施

### 1. 模型架构优化

#### 1.1 基础模型升级
- 采用ConvNeXt Base作为主干网络，该模型在ImageNet上取得了优秀的性能
- 模型预训练权重来自IN22K（ImageNet-22K），提供更丰富的预训练特征

#### 1.2 模型集成策略
- 使用三个互补的模型进行集成：
  - ConvNeXt Base：现代CNN架构，强大的特征提取能力
  - ViT Base：Vision Transformer架构，擅长捕捉全局关系
  - DeiT Base：数据高效的Vision Transformer，带有蒸馏机制
- 使用加权平均进行预测集成，权重分配为[0.4, 0.3, 0.3]

### 2. 数据增强升级

#### 2.1 基础数据增强
- RandomResizedCrop：随机裁剪和缩放，scale范围[0.5, 1.0]
- 水平翻转：p=0.5
- 旋转和缩放：
  - 旋转范围：±15度
  - 位移范围：±10%
  - 缩放范围：±20%

#### 2.2 高级数据增强
- RandAugment：自动数据增强策略
  - 强度：m9-n3-mstd0.5
  - 应用概率：0.3
- 噪声和模糊增强：
  - 高斯噪声
  - 高斯模糊
  - 运动模糊
- 几何变换：
  - 光学畸变
  - 网格畸变
  - 弹性变换

#### 2.3 混合策略
- Mixup：alpha=0.2，概率=0.5
- CutMix：概率=0.5
- 标签平滑：0.1

### 3. 训练策略优化

#### 3.1 学习率调度
- 使用带warmup的余弦退火调度
- warmup轮数：3 epochs
- 最小学习率：1e-7
- 初始学习率：1e-4

#### 3.2 优化器配置
- 采用AdamW优化器
- 权重衰减：1e-2
- 批次大小：64

#### 3.3 交叉验证
- 实现5折交叉验证
- 保存每折最佳模型
- 使用模型集成进行最终预测

### 4. 测试时优化

#### 4.1 测试时增强(TTA)
- 水平翻转
- 多尺度测试（0.9x和1.1x）
- 预测结果平均

#### 4.2 推理优化
- 使用模型集成
- 批量预测
- 异步数据加载

### 5. 工程实践改进

#### 5.1 错误处理
- 完整的异常捕获和日志记录
- 数据完整性验证
- 模型保存和加载的健壮性检查

#### 5.2 性能优化
- 异步数据加载
- 多进程数据预处理
- GPU内存优化

#### 5.3 监控和日志
- 详细的训练过程日志
- 类别分布统计
- 验证集性能跟踪

## 使用说明

### 环境要求
```
torch>=1.9.0
torchvision>=0.10.0
timm>=0.9.2
pandas>=1.3.0
Pillow>=8.3.1
tqdm>=4.62.0
albumentations>=1.3.1
numpy>=1.21.0
scikit-learn>=1.0.0
```

### 训练流程
1. 准备数据集
2. 修改config.py中的配置
3. 运行训练：
```bash
python train_advanced.py
```

### 预测
```bash
python predict.py
```

## 未来改进方向

1. 模型优化
   - 尝试更新的模型架构
   - 探索更多的模型集成策略

2. 训练策略
   - 实现渐进式学习
   - 添加对比学习预训练
   - 探索更多的数据增强组合

3. 工程优化
   - 添加分布式训练支持
   - 实现模型量化
   - 优化推理速度

## 贡献指南

欢迎提交Issue和Pull Request来改进项目。在提交代码前，请确保：
1. 代码风格符合项目规范
2. 添加适当的注释和文档
3. 所有测试用例通过

## 许可证

本项目采用MIT许可证。详见LICENSE文件。
